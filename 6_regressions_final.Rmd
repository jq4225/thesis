---
title: "6_regressions_final"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lfe)
library(texreg)
```

In order: do business closures (all), business closures(filtered), SIP (all), SIP (closures)
```{r}
# depression

depression_sip_all <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
               cases_per_100k +
                 unemploy_rate + debt_contract_relief + income_support + 
                 precip + temp + covid + lockdown|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_sip_part <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + covid + lockdown|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

depression_bus_all <- felm(I(log(depression + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + lockdown|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_bus_part <- felm(I(log(depression + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 log(unemploy_rate+1) + factor(debt_contract_relief) + factor(income_support) + 
                 log(precip+1) + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(depression_bus_all, depression_bus_part, depression_sip_all, depression_sip_part),
        digits = 4, include.ci = FALSE, file = "depression.doc")
```


```{r}

# With logs

depression_sip_all <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid + 1) + log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_sip_part <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

depression_bus_all <- felm(I(log(depression + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_bus_part <- felm(I(log(depression + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(depression_bus_all, depression_bus_part, depression_sip_all, depression_sip_part),
        digits = 4, include.ci = FALSE, file = "depression.doc")
```
```{r}
# depression

anxiety_sip_all <- felm(I(log(anxiety + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid + 1) + log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

anxiety_sip_part <- felm(I(log(anxiety + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

anxiety_bus_all <- felm(I(log(anxiety + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

anxiety_bus_part <- felm(I(log(anxiety + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(anxiety_bus_all, anxiety_bus_part, anxiety_sip_all, anxiety_sip_part),
        digits = 4, include.ci = FALSE, file = "anxiety.doc")
```
```{r}
panic_sip_all <- felm(I(log(panic + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid + 1) + log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

panic_sip_part <- felm(I(log(panic + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

panic_bus_all <- felm(I(log(panic + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

panic_bus_part <- felm(I(log(panic + 1)) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(panic_bus_all, panic_bus_part, panic_sip_all, panic_sip_part),
        digits = 4, include.ci = FALSE, file = "panic.doc")
```
```{r}
worry_bus_part <- felm(I(log(worry + 1 )) ~  
                 busclose_first * year_indicator + busopen_most_pop * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + 
                   factor(income_support)  + 
                 precip + temp + log(covid + 1) + 
                   log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v12_5)
```

```{r}
htmlreg(l = list(anxiety_bus_all, crying_bus_all, depression_bus_all, lonely_bus_all, panic_bus_all, worry_bus_all, mental_health_bus_all), include.ci = FALSE, digits = 4, file = "mental_health_bus_prelim.doc")

htmlreg(l = list(anxiety_bus_part, crying_bus_part, depression_bus_part, lonely_bus_part, panic_bus_part, worry_bus_part, mental_health_bus_part), include.ci = FALSE, digits = 4, file = "mental_health_bus_prelim_5.doc")
```
```{r}
# Let's try some other stuff

depression_bus_part <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator * factor(covid_pp) + 
                busopen_most_pop * year_indicator * factor(covid_pp) + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + 
                   factor(income_support)  + 
                 precip + temp + log(covid + 1) * factor(year_indicator) + 
                   log(lockdown + 1) * factor(year_indicator)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v12_5)
```

