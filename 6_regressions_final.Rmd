---
title: "6_regressions_final"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lfe)
library(texreg)
```

In order: do business closures (all), business closures(filtered), SIP (all), SIP (closures)
```{r}
# depression

depression_sip_all <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
               cases_per_100k +
                 unemploy_rate + debt_contract_relief + income_support + 
                 precip + temp + covid + lockdown|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_sip_part <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + covid + lockdown|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

depression_bus_all <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + lockdown|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_bus_part <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 log(unemploy_rate+1) + factor(debt_contract_relief) + factor(income_support) + 
                 log(precip+1) + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(depression_bus_all, depression_bus_part, depression_sip_all, depression_sip_part),
        digits = 4, include.ci = FALSE, file = "depression.doc")
```


```{r}

# With logs

depression_sip_all <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid + 1) + log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_sip_part <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

depression_bus_all <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

depression_bus_part <- felm(I(log(depression + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(depression_bus_all, depression_bus_part, depression_sip_all, depression_sip_part),
        digits = 4, include.ci = FALSE, file = "depression.doc")
```
```{r}
# depression

anxiety_sip_all <- felm(I(log(anxiety + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid + 1) + log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

anxiety_sip_part <- felm(I(log(anxiety + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

anxiety_bus_all <- felm(I(log(anxiety + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

anxiety_bus_part <- felm(I(log(anxiety + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(anxiety_bus_all, anxiety_bus_part, anxiety_sip_all, anxiety_sip_part),
        digits = 4, include.ci = FALSE, file = "anxiety.doc")
```
```{r}
panic_sip_all <- felm(I(log(panic + 1 )) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid + 1) + log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

panic_sip_part <- felm(I(log(panic + 1)) ~  
                 sip_first * year_indicator + no_sip_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

panic_bus_all <- felm(I(log(panic + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11)

panic_bus_part <- felm(I(log(panic + 1)) ~  
                 sip_first * year_indicator + busopen_most_pop * year_indicator +
               cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + factor(income_support) + 
                 precip + temp + 
                 log(covid+1) + log(lockdown+1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v11_5)

htmlreg(l = list(panic_bus_all, panic_bus_part, panic_sip_all, panic_sip_part),
        digits = 4, include.ci = FALSE, file = "panic.doc")
```
```{r}
mental_health_bus_part <- felm(I(log(mental_health + 1 )) ~  
                 sip_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                school_first * year_indicator + online_only * year_indicator + 
                  hybrid * year_indicator + on_premises * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + 
                   factor(income_support)  + 
                 precip + temp + log(covid + 1) + 
                   log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v14_5)
```

```{r}
htmlreg(l = list(anxiety_bus_all, crying_bus_all, depression_bus_all, lonely_bus_all, panic_bus_all, worry_bus_all, mental_health_bus_all), include.ci = FALSE, digits = 4, file = "mental_health_bus_prelim.doc")

htmlreg(l = list(anxiety_bus_part, crying_bus_part, depression_bus_part, lonely_bus_part, panic_bus_part, worry_bus_part, mental_health_bus_part), include.ci = FALSE, digits = 4, file = "mental_health_bus_prelim_5.doc")
```
```{r}
# Let's try some other stuff

yoga_bus_part <- felm(I(log(yoga + 1 )) ~  
                 sip_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                school_pop_pct * year_indicator + online_only * year_indicator + 
                  hybrid * year_indicator + on_premises * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + 
                   factor(income_support)  + 
                 precip + temp + log(covid + 1) + 
                   log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v14_5)

htmlreg(l = list(crying_bus_part, depression_bus_part,
                 lonely_bus_part, sad_bus_part, suicide_bus_part, tired_bus_part),
        include.ci = FALSE, digits = 4, file = "depression_prelim.doc")

htmlreg(l = list(anxiety_bus_part, nervous_bus_part, 
                 stress_bus_part, worry_bus_part, panic_bus_part),
        include.ci = FALSE, digits = 4, file = "anxiety_prelim.doc")


htmlreg(l = list(alcohol_bus_part, alcoholism_bus_part, 
                 cannabis_bus_part, cigarette_bus_part, drug_bus_part,
                 e_cig_bus_part, smoking_bus_part, substance_abuse_bus_part),
        include.ci = FALSE, digits = 4, file = "substance_prelim.doc")

htmlreg(l = list(exercise_bus_part, therapy_bus_part, 
                 yoga_bus_part),
        include.ci = FALSE, digits = 4, file = "coping_prelim.doc")
```
```{r}
# school only
yoga_bus_part <- felm(I(log(yoga + 1 )) ~  
                school_pop_pct * year_indicator + online_only * year_indicator + 
                  hybrid * year_indicator + other * year_indicator + 
                 cases_per_100k +
                 unemploy_rate + factor(debt_contract_relief) + 
                   factor(income_support)  + 
                 precip + temp + log(covid + 1) + 
                   log(lockdown + 1)|
                 factor(dma):factor(year) + factor(week)|0|dma, 
             data = searches_norm3_v14_5)
```


```{r}
# Replicating Brodeur et al

# weights = na.omit(searches_norm3_v14_5$pop),
#                   data = searches_norm3_v14_5 %>% filter(is.na(pop) == FALSE)

anxiety_1 <- felm(I(log(anxiety + 1)) ~ 
                        busclose_first * year_indicator + 
                        cases_per_100k|factor(week) + factor(dma):factor(year)|0|dma,
                  data = searches_norm3_v14_5)

anxiety_2 <- felm(I(log(anxiety + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k|factor(week) + factor(dma):factor(year)|0|dma,
                        data = searches_norm3_v14_5)

anxiety_3 <- felm(I(log(anxiety + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate|factor(week) + factor(dma):factor(year)|0|dma,
                        data = searches_norm3_v14_5)

anxiety_4 <- felm(I(log(anxiety + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        data = searches_norm3_v14_5)

anxiety_5 <- felm(I(log(anxiety + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen _most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1)
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        data = searches_norm3_v14_5)

anxiety_6 <- felm(I(log(anxiety + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        data = searches_norm3_v14_5)
anxiety_7 <- felm(I(log(anxiety + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        data = searches_norm3_v14_5)

htmlreg(l = list(anxiety_1, anxiety_2, anxiety_3, anxiety_4, 
                 anxiety_5, anxiety_6, anxiety_7), include.ci = FALSE,
        digits = 4, file = "anxiety_multi.doc")



# depression_orig <- felm(I(log(depression + 1)) ~ 
#                         sip_first * year_indicator + 
#                         cases_per_100k|factor(week) + factor(dma):factor(year)|0|dma,
#                         data = searches_v21_5)


```

```{r}
# Running again w/ population weights

# weights = na.omit(searches_norm3_v14_5$pop),
#                   data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE)


depression_1 <- felm(I(log(depression + 1)) ~ 
                        busclose_first * year_indicator + 
                        cases_per_100k|factor(week) + factor(dma):factor(year)|0|dma,
                  weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

depression_2 <- felm(I(log(depression + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k|factor(week) + factor(dma):factor(year)|0|dma,
                        weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

depression_3 <- felm(I(log(depression + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate|factor(week) + factor(dma):factor(year)|0|dma,
                        weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

depression_4 <- felm(I(log(depression + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

depression_5 <- felm(I(log(depression + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1)
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

depression_6 <- felm(I(log(depression + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))
depression_7 <- felm(I(log(depression + 1)) ~ 
                        busclose_first * year_indicator + 
                        busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma):factor(year)|0|dma,
                        weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_1, depression_2, depression_3, depression_4, 
                 depression_5, depression_6, depression_7), include.ci = FALSE,
        digits = 4, file = "depression_multi_weighted.doc")
```

```{r}
# Let's REWEIGHTTTT

searches_norm3_v15 <- searches_norm3_v14 %>%
        group_by(dma, year) %>%
        mutate(average_3_ann = mean(average_3, na.rm = TRUE)) %>% 
        ungroup() %>% 
        mutate(average_3_ratio = average_3 / average_3_ann) %>% 
        mutate(across(c(alcohol:TV, cannabis:lockdown,
                        alone:sad), ~ . * average_3 / average_3_ratio)) %>% 
         mutate(across(c(alcohol:TV, cannabis:lockdown,
                        alone:sad), ~ . * 100 / max(.)))

# read in dma_5
searches_norm3_v15_5 <- searches_norm3_v15 %>%
        filter(dma %in% dma_5)

# Graph

searches_norm3_v15_5 %>% 
        group_by(date) %>% 
        summarize(ratio = mean(average_3_ratio, na.rm = TRUE)) %>% 
        mutate(date = as_date(date)) %>% 
        ggplot(aes(x = date, y = ratio)) + 
          geom_line() +
          theme_classic() +
          labs(x = "Date", y = "Yearly SVI Ratio") + 
          scale_x_date(breaks = "6 months", date_labels = "%m/%y")

# Let's add in some other stuff for regions

northeast <- c("CT", "ME", "MA", "NH", "RI", "VT", "NY", "NJ", "DE", "PA")

midwest <- c("IL", "IN", "MI", "OH", "WI", "IA", "KS", "MN", "MO", "NE", "ND", "SD")

south <- c("FL", "GA", "MD", "NC", "SC", "VA", "DC", "WV", "AL", "KY", "MS", "TN", "AR",
           "LA", "TX", "OK")

west <- c("AZ", "CO", "ID", "MT", "NV", "NM", "UT", "WY", "AK", "CA", "HI", "OR", "WA")

searches_norm3_v17 <- searches_norm3_v15 %>% 
        mutate(region = ifelse(state %in% northeast, "northeast",
                               ifelse(state %in% midwest, "midwest",
                                      ifelse(state %in% south, "south", 
                                             ifelse(state %in% west, "west", state)))))

searches_norm3_v17_5 <- searches_norm3_v17 %>% 
        filter(dma %in% dma_5)







```


```{r}
# Do prcomp
pca_dep <- searches_norm3_v15_5 %>%
        select(crying, depression, lonely, sad, tired)

pca_weights_dep <- prcomp(pca_dep)

rotation_dep <- as_tibble(pca_weights_dep$rotation, rownames = "term")

pca_anx <- searches_norm3_v15_5 %>% 
        select(anxiety, nervous, stress, worry, panic)

pca_weights_anx <- prcomp(pca_anx)

rotation_anx <- as_tibble(pca_weights_anx$rotation, rownames = "term")

pca_substance <- searches_norm3_v15_5 %>%
        select(alcohol, alcoholism, cannabis, cigarette, e_cig, substance_abuse,
               smoking)

pca_weights_sub <- prcomp(pca_substance)

rotation_sub <- as_tibble(pca_weights_sub$rotation, rownames = "term")

pca_alcohol <- searches_norm3_v18_5 %>%
        select(alcohol, alcoholism)

pca_smoking <- searches_norm3_v18_5 %>%
        select(cigarette, e_cig, smoking)
```


```{r}
# Depression for the preliminary paper

depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# Population weights
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```


```{r}
depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v15_5)

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v22_5$pop),
                  data = searches_norm3_v_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```

```{r}

# Region FEs

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)  + 
                               factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                               factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                               factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                               factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")

```
```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                               factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                               factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                               factor(region):factor(month)|0|dma, 
            weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                               factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```
```{r}
# Total -- all things

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17$pop),
                  data = searches_norm3_v17 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```
```{r}
# Traditional DID setup

depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first:year_indicator + 
                no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                 sip_first:year_indicator + 
                no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485*crying + 0.782*depression + 
                                0.127*lonely + 0.320*sad + 0.184*tired + 1)) ~ 
                                     sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.485*crying + 0.782*depression + 
                                0.127*lonely + 0.320*sad + 0.184*tired + 1)) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator +
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator +
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator +
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                 busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
# Denrmalized

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```


```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v21_5$pop),
                  data = searches_v21_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# population percent

depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_pop_pct * year_indicator + 
                no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                 sip_pop_pct * year_indicator + 
                no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v15_5$pop),
                  data = searches_norm3_v15_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_pop_pct * year_indicator + 
                busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_pop_pct * year_indicator + 
                busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v17_5$pop),
                  data = searches_norm3_v17_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```

```{r}
# RACE

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator * black_pct + 
                busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator * black_pct + 
                busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")

```

```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator * black_pct + 
                no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                  sip_first * year_indicator * black_pct + 
                no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                      sip_first * year_indicator * black_pct + 
                no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator * black_pct + 
                no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# White people
depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator * white_pct + 
                busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator * white_pct + 
                busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")

```

```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator * white_pct + 
                no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                  sip_first * year_indicator * white_pct + 
                no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                      sip_first * year_indicator * white_pct + 
                no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator * white_pct + 
                no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# pop den

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator * I(pop_den/100) + 
                busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator * I(pop_den/100) + 
                busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")

```

```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator * I(pop_den/100) + 
                no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                  sip_first * year_indicator * I(pop_den/100) + 
                no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                      sip_first * year_indicator * I(pop_den/100) + 
                no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```


```{r}
# Politics

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator * gop_pct + 
                busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator * gop_pct + 
                busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```

```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator * gop_pct + 
                no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                  sip_first * year_indicator * gop_pct + 
                no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                      sip_first * year_indicator * gop_pct + 
                no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator * gop_pct + 
                no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
#Income 

depression_bus <- felm(I(log(depression + 1 )) ~  
                 busclose_first * year_indicator * I(median_income/1000) + 
                busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus <- felm(I(log(anxiety + 1 )) ~  
                 busclose_first * year_indicator * I(median_income/1000) + 
                busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_bus_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                     busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_bus_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_bus, depression_bus_index, anxiety_bus, anxiety_bus_index),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```

```{r}
depression_sip <- felm(I(log(depression + 1 )) ~  
                 sip_first * year_indicator * I(median_income/1000) + 
                no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip <- felm(I(log(anxiety + 1 )) ~  
                  sip_first * year_indicator * I(median_income/1000) + 
                no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

depression_sip_index <- felm(I(log(0.485 * crying + 0.782 * depression + 
                                0.127 * lonely + 0.320 * sad + 0.184 * tired + 1)) ~ 
                                      sip_first * year_indicator * I(median_income/1000) + 
                no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

anxiety_sip_index <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic + 1)) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(depression_sip, depression_sip_index, anxiety_sip, anxiety_sip_index),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# State level
# pca

pca_dep <- hps_all_v11 %>%
        select(crying_norm, depression_norm, lonely_norm, sad_norm, tired_norm)

pca_weights_dep <- prcomp(pca_dep)

rotation_dep <- as_tibble(pca_weights_dep$rotation, rownames = "term")

pca_anx <- hps_all_v11 %>% 
        select(anxiety_norm, nervous_norm, stress_norm, worry_norm, panic_norm)

pca_weights_anx <- prcomp(pca_anx)

rotation_anx <- as_tibble(pca_weights_anx$rotation, rownames = "term")

```


```{r}
# State outcome regressions

depression_1 <- felm(log(hps_depression) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_norm) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(I(log(0.353 * crying_norm + 
                                                   0.163 * depression_norm + 
                                                   0.529 * lonely_norm + 
                                                   0.586 * sad_norm + 
                                                   0.475 * tired_norm)) ~ 
                             factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_1 <- felm(log(hps_anxiety) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_2 <- felm(log(anxiety_norm) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_3 <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic)) ~ 
                             factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
depression_1 <- felm(log(hps_depression) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_norm) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(I(log(0.353 * crying_norm + 
                                                   0.163 * depression_norm + 
                                                   0.529 * lonely_norm + 
                                                   0.586 * sad_norm + 
                                                   0.475 * tired_norm)) ~ 
                             factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_1 <- felm(log(hps_anxiety) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_2 <- felm(log(anxiety_norm) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_3 <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic)) ~ 
                             factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
depression_1 <- felm(log(hps_depression) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_norm) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(I(log(0.353 * crying_norm + 
                                                   0.163 * depression_norm + 
                                                   0.529 * lonely_norm + 
                                                   0.586 * sad_norm + 
                                                   0.475 * tired_norm)) ~ 
                             stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_1 <- felm(log(hps_anxiety) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_2 <- felm(log(anxiety_norm) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_3 <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic)) ~ 
                             stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
depression_1 <- felm(log(hps_depression) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_norm) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(I(log(0.353 * crying_norm + 
                                                   0.163 * depression_norm + 
                                                   0.529 * lonely_norm + 
                                                   0.586 * sad_norm + 
                                                   0.475 * tired_norm)) ~ 
                             factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_1 <- felm(log(hps_anxiety) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_2 <- felm(log(anxiety_norm) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_3 <- felm(I(log(0.924 * anxiety + 0.213 * nervous + 
                                0.133 * stress + 0.198 * worry + 0.211 * panic)) ~ 
                             factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```
```{r}
# Subpopulation -- black? -- depression

depression_1 <- felm(log(depression_black + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))


depression_2 <- felm(log(depression_black + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(log(depression_black + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_4 <- felm(log(depression_black + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))



htmlreg(l = list(depression_1,depression_2, depression_3, depression_4),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
# black - anxiety

anxiety_1 <- felm(log(anxiety_agg_black + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_2 <- felm(log(anxiety_agg_black + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


anxiety_3 <- felm(log(anxiety_agg_black + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_4 <- felm(log(anxiety_agg_black + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(anxiety_1,anxiety_2, anxiety_3, anxiety_4),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```
```{r}
# Subpopulation -- white? -- depression

depression_1 <- felm(log(depression_white + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))


depression_2 <- felm(log(depression_white + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(log(depression_white + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_4 <- felm(log(depression_white + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))



htmlreg(l = list(depression_1,depression_2, depression_3, depression_4),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
# white - anxiety

anxiety_1 <- felm(log(anxiety_agg_white + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_2 <- felm(log(anxiety_agg_white + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


anxiety_3 <- felm(log(anxiety_agg_white + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_4 <- felm(log(anxiety_agg_white + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(anxiety_1,anxiety_2, anxiety_3, anxiety_4),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
# Income and depression

depression_1 <- felm(log(depression_less25k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_25to35k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(log(depression_35to50k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_4 <- felm(log(depression_50to75k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_5 <- felm(log(depression_75to100k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_6 <- felm(log(depression_100to150k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


depression_7 <- felm(log(depression_150to200k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))
# 
# 
# anxiety_1 <- felm(log(anxiety_agg_black + 1) ~ factor(c2_workplace_closing)  +
#                initclaims_combined + 
#                contclaims_combined + cases_per_100k_5day + 
#                factor(e1_income_support) + factor(e2_debt_contract_relief) + 
#                 log(covid_norm+1) + log(lockdown_norm+1)
#              |factor(period) + factor(state) + factor(year)|0|state,
#              data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))



htmlreg(l = list(depression_1, depression_2, depression_3, depression_4, depression_5,
                 depression_6, depression_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```
```{r}
depression_1 <- felm(log(depression_less25k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_25to35k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(log(depression_35to50k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_4 <- felm(log(depression_50to75k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_5 <- felm(log(depression_75to100k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_6 <- felm(log(depression_100to150k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


depression_7 <- felm(log(depression_150to200k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, depression_4, depression_5,
                 depression_6, depression_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
depression_1 <- felm(log(depression_less25k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_25to35k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(log(depression_35to50k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_4 <- felm(log(depression_50to75k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_5 <- felm(log(depression_75to100k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_6 <- felm(log(depression_100to150k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


depression_7 <- felm(log(depression_150to200k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, depression_4, depression_5,
                 depression_6, depression_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```
```{r}
depression_1 <- felm(log(depression_less25k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_2 <- felm(log(depression_25to35k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_3 <- felm(log(depression_35to50k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_4 <- felm(log(depression_50to75k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_5 <- felm(log(depression_75to100k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

depression_6 <- felm(log(depression_100to150k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


depression_7 <- felm(log(depression_150to200k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, depression_4, depression_5,
                 depression_6, depression_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
# Income and anxiety
anxiety_agg_1 <- felm(log(anxiety_agg_less25k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_2 <- felm(log(anxiety_agg_25to35k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_3 <- felm(log(anxiety_agg_35to50k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_4 <- felm(log(anxiety_agg_50to75k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_5 <- felm(log(anxiety_agg_75to100k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_6 <- felm(log(anxiety_agg_100to150k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


anxiety_agg_7 <- felm(log(anxiety_agg_150to200k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))



htmlreg(l = list(anxiety_agg_1, anxiety_agg_2, anxiety_agg_3, anxiety_agg_4, anxiety_agg_5,
                 anxiety_agg_6, anxiety_agg_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```
```{r}
anxiety_agg_1 <- felm(log(anxiety_agg_less25k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_2 <- felm(log(anxiety_agg_25to35k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_3 <- felm(log(anxiety_agg_35to50k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_4 <- felm(log(anxiety_agg_50to75k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_5 <- felm(log(anxiety_agg_75to100k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_6 <- felm(log(anxiety_agg_100to150k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


anxiety_agg_7 <- felm(log(anxiety_agg_150to200k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(anxiety_agg_1, anxiety_agg_2, anxiety_agg_3, anxiety_agg_4, anxiety_agg_5,
                 anxiety_agg_6, anxiety_agg_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```
```{r}
anxiety_agg_1 <- felm(log(anxiety_agg_less25k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_2 <- felm(log(anxiety_agg_25to35k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_3 <- felm(log(anxiety_agg_35to50k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_4 <- felm(log(anxiety_agg_50to75k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_5 <- felm(log(anxiety_agg_75to100k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_6 <- felm(log(anxiety_agg_100to150k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


anxiety_agg_7 <- felm(log(anxiety_agg_150to200k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(anxiety_agg_1, anxiety_agg_2, anxiety_agg_3, anxiety_agg_4, anxiety_agg_5,
                 anxiety_agg_6, anxiety_agg_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
anxiety_agg_1 <- felm(log(anxiety_agg_less25k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_2 <- felm(log(anxiety_agg_25to35k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_3 <- felm(log(anxiety_agg_35to50k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_4 <- felm(log(anxiety_agg_50to75k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_5 <- felm(log(anxiety_agg_75to100k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

anxiety_agg_6 <- felm(log(anxiety_agg_100to150k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


anxiety_agg_7 <- felm(log(anxiety_agg_150to200k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(anxiety_agg_1, anxiety_agg_2, anxiety_agg_3, anxiety_agg_4, anxiety_agg_5,
                 anxiety_agg_6, anxiety_agg_7),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
# Therapy and coping mechs

exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))


htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```


```{r}
# SIP and coping

exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```
```{r}
exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma,
                  data = searches_norm3_v18_5)

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v18_5)

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v18_5)

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            data = searches_norm3_v18_5)

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```
```{r}
exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```
```{r}
exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first:year_indicator + 
                no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first:year_indicator + 
                no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```
```{r}
exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_pop_pct * year_indicator + 
                no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_pop_pct * year_indicator + 
                no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")

```
```{r}
exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator + 
                no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# BUS and coping

exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma,
                  data = searches_norm3_v18_5)

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v18_5)

therapy_bus <- felm(I(log(therapy + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v18_5)

yoga_bus <- felm(I(log(yoga + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            data = searches_norm3_v18_5)

htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first:year_indicator + 
                busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first:year_indicator + 
                busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1)) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1)) ~ 
                                     busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_pop_pct * year_indicator + 
                busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_pop_pct * year_indicator + 
                busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1)) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1)) ~ 
                                     busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")

```
```{r}
exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18$pop),
                  data = searches_norm3_v18 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```

```{r}
exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator + 
                busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1)) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1)) ~ 
                                     busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_v22_5$pop),
                  data = searches_v22_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```
```{r}
# Therapy

therapy_1 <- felm(log(counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_2 <- felm(log(therapy_norm + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_3 <- felm(log(medication) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_4 <- felm(log(medication_or_counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_5 <- felm(log(no_counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")

```
```{r}
therapy_1 <- felm(log(counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 )

therapy_2 <- felm(log(therapy_norm + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 )

therapy_3 <- felm(log(medication) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 )

therapy_4 <- felm(log(medication_or_counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 )

therapy_5 <- felm(log(no_counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_2 <- felm(log(therapy_norm + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_3 <- felm(log(medication) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_4 <- felm(log(medication_or_counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_5 <- felm(log(no_counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(therapy_norm + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(medication) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_4 <- felm(log(medication_or_counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_5 <- felm(log(no_counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_2 <- felm(log(therapy_norm + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_3 <- felm(log(medication) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_4 <- felm(log(medication_or_counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_5 <- felm(log(no_counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(therapy_norm + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(medication) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_4 <- felm(log(medication_or_counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_5 <- felm(log(no_counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_2 <- felm(log(therapy_norm + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_3 <- felm(log(medication) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_4 <- felm(log(medication_or_counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

therapy_5 <- felm(log(no_counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),
             weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```
```{r}
therapy_1 <- felm(log(counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(therapy_norm + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(medication) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_4 <- felm(log(medication_or_counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_5 <- felm(log(no_counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```
```{r}
therapy_1 <- felm(log(share_counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_3 <- felm(log(share_medication) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_4 <- felm(log(share_medication_or_counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_5 <- felm(log(share_no_counseling) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)
```

```{r}
# Therapy and race

exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator * black_pct + 
                busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator * black_pct + 
                busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1 )) ~  
                 busclose_first * year_indicator * black_pct + 
                busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1 )) ~  
                 busclose_first * year_indicator * black_pct + 
                busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))


htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```


```{r}
# SIP and coping

exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator * black_pct + 
                no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator * black_pct + 
                no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```
```{r}
# Therapy and white

exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator * white_pct + 
                busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator * white_pct + 
                busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1 )) ~  
                 busclose_first * year_indicator * white_pct + 
                busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1 )) ~  
                 busclose_first * year_indicator * white_pct + 
                busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))


htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```


```{r}
# SIP and coping

exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator * white_pct + 
                no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator * white_pct + 
                no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# Therapy and white

exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator * I(pop_den/100) + 
                busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator * I(pop_den/100) + 
                busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1 )) ~  
                 busclose_first * year_indicator * I(pop_den/100) + 
                busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1 )) ~  
                 busclose_first * year_indicator * I(pop_den/100) + 
                busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))


htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```


```{r}
# SIP and coping

exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator * I(pop_den/100) + 
                no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator * I(pop_den/100) + 
                no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```


```{r}
# Therapy and gop

exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator * gop_pct + 
                busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator * gop_pct + 
                busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1 )) ~  
                 busclose_first * year_indicator * gop_pct + 
                busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1 )) ~  
                 busclose_first * year_indicator * gop_pct + 
                busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))


htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```


```{r}
# SIP and coping

exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator * gop_pct + 
                no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator * gop_pct + 
                no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ sm
                                     sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```

```{r}
# Therapy and income

exercise_bus <- felm(I(log(exercise + 1 )) ~  
                 busclose_first * year_indicator * I(median_income/1000) + 
                busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_bus <- felm(I(log(sleep + 1 )) ~  
                 busclose_first * year_indicator * I(median_income/1000) + 
                busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_bus <- felm(I(log(therapy + 1 )) ~  
                 busclose_first * year_indicator * I(median_income/1000) + 
                busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_bus <- felm(I(log(yoga + 1 )) ~  
                 busclose_first * year_indicator * I(median_income/1000) + 
                busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))


htmlreg(l = list(exercise_bus, sleep_bus, therapy_bus, yoga_bus),
        include.ci = FALSE, digits = 4, file = "bus.doc")
```


```{r}
# SIP and coping

exercise_sip <- felm(I(log(exercise + 1 )) ~  
                 sip_first * year_indicator * I(median_income/1000) + 
                no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

sleep_sip <- felm(I(log(sleep + 1 )) ~  
                 sip_first * year_indicator * I(median_income/1000) + 
                no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

therapy_sip <- felm(I(log(therapy + 1)) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

yoga_sip <- felm(I(log(yoga + 1)) ~ 
                                     sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            weights = na.omit(searches_norm3_v18_5$pop),
                  data = searches_norm3_v18_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(exercise_sip, sleep_sip, therapy_sip, yoga_sip),
        include.ci = FALSE, digits = 4, file = "sip.doc")
```


```{r}
therapy_1 <- felm(log(counseling_black+1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_black+1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_black+1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```
```{r}
therapy_1 <- felm(log(counseling_black+1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_black+1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_black+1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling_black+1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_black+1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_black+1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling_black+1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_black+1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_black+1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling_white+1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_white+1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_white+1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling_white+1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_white+1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_white+1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling_white+1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_white+1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_white+1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
therapy_1 <- felm(log(counseling_white+1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

therapy_2 <- felm(log(medication_white+1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v11)

therapy_3 <- felm(log(no_counseling_white+1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11)

htmlreg(l = list(therapy_1, therapy_2, therapy_3),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
counseling_1 <- felm(log(counseling_less25k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_2 <- felm(log(counseling_25to35k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_3 <- felm(log(counseling_35to50k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_4 <- felm(log(counseling_50to75k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_5 <- felm(log(counseling_75to100k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_6 <- felm(log(counseling_100to150k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


counseling_7 <- felm(log(counseling_150to200k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(counseling_1, counseling_2, counseling_3, counseling_4, counseling_5,
                 counseling_6, counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```
```{r}
counseling_1 <- felm(log(counseling_less25k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_2 <- felm(log(counseling_25to35k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_3 <- felm(log(counseling_35to50k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_4 <- felm(log(counseling_50to75k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_5 <- felm(log(counseling_75to100k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_6 <- felm(log(counseling_100to150k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


counseling_7 <- felm(log(counseling_150to200k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(counseling_1, counseling_2, counseling_3, counseling_4, counseling_5,
                 counseling_6, counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```


```{r}
counseling_1 <- felm(log(counseling_less25k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_2 <- felm(log(counseling_25to35k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_3 <- felm(log(counseling_35to50k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_4 <- felm(log(counseling_50to75k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_5 <- felm(log(counseling_75to100k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_6 <- felm(log(counseling_100to150k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


counseling_7 <- felm(log(counseling_150to200k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(counseling_1, counseling_2, counseling_3, counseling_4, counseling_5,
                 counseling_6, counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
counseling_1 <- felm(log(counseling_less25k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_2 <- felm(log(counseling_25to35k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_3 <- felm(log(counseling_35to50k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_4 <- felm(log(counseling_50to75k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_5 <- felm(log(counseling_75to100k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

counseling_6 <- felm(log(counseling_100to150k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


counseling_7 <- felm(log(counseling_150to200k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(counseling_1, counseling_2, counseling_3, counseling_4, counseling_5,
                 counseling_6, counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```


```{r}
medication_1 <- felm(log(medication_less25k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_2 <- felm(log(medication_25to35k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_3 <- felm(log(medication_35to50k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_4 <- felm(log(medication_50to75k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_5 <- felm(log(medication_75to100k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_6 <- felm(log(medication_100to150k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


medication_7 <- felm(log(medication_150to200k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(medication_1, medication_2, medication_3, medication_4, medication_5,
                 medication_6, medication_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
medication_1 <- felm(log(medication_less25k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_2 <- felm(log(medication_25to35k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_3 <- felm(log(medication_35to50k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_4 <- felm(log(medication_50to75k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_5 <- felm(log(medication_75to100k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_6 <- felm(log(medication_100to150k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


medication_7 <- felm(log(medication_150to200k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(medication_1, medication_2, medication_3, medication_4, medication_5,
                 medication_6, medication_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
medication_1 <- felm(log(medication_less25k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_2 <- felm(log(medication_25to35k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_3 <- felm(log(medication_35to50k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_4 <- felm(log(medication_50to75k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_5 <- felm(log(medication_75to100k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_6 <- felm(log(medication_100to150k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


medication_7 <- felm(log(medication_150to200k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(medication_1, medication_2, medication_3, medication_4, medication_5,
                 medication_6, medication_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
medication_1 <- felm(log(medication_less25k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_2 <- felm(log(medication_25to35k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_3 <- felm(log(medication_35to50k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_4 <- felm(log(medication_50to75k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_5 <- felm(log(medication_75to100k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

medication_6 <- felm(log(medication_100to150k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


medication_7 <- felm(log(medication_150to200k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(medication_1, medication_2, medication_3, medication_4, medication_5,
                 medication_6, medication_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
no_counseling_1 <- felm(log(no_counseling_less25k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_2 <- felm(log(no_counseling_25to35k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_3 <- felm(log(no_counseling_35to50k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_4 <- felm(log(no_counseling_50to75k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_5 <- felm(log(no_counseling_75to100k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_6 <- felm(log(no_counseling_100to150k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


no_counseling_7 <- felm(log(no_counseling_150to200k + 1) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(no_counseling_1, no_counseling_2, no_counseling_3, no_counseling_4, no_counseling_5,
                 no_counseling_6, no_counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
no_counseling_1 <- felm(log(no_counseling_less25k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_2 <- felm(log(no_counseling_25to35k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_3 <- felm(log(no_counseling_35to50k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_4 <- felm(log(no_counseling_50to75k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_5 <- felm(log(no_counseling_75to100k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_6 <- felm(log(no_counseling_100to150k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


no_counseling_7 <- felm(log(no_counseling_150to200k + 1) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(no_counseling_1, no_counseling_2, no_counseling_3, no_counseling_4, no_counseling_5,
                 no_counseling_6, no_counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
no_counseling_1 <- felm(log(no_counseling_less25k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_2 <- felm(log(no_counseling_25to35k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_3 <- felm(log(no_counseling_35to50k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_4 <- felm(log(no_counseling_50to75k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_5 <- felm(log(no_counseling_75to100k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_6 <- felm(log(no_counseling_100to150k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


no_counseling_7 <- felm(log(no_counseling_150to200k + 1) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(no_counseling_1, no_counseling_2, no_counseling_3, no_counseling_4, no_counseling_5,
                 no_counseling_6, no_counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```
```{r}
no_counseling_1 <- felm(log(no_counseling_less25k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_2 <- felm(log(no_counseling_25to35k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_3 <- felm(log(no_counseling_35to50k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_4 <- felm(log(no_counseling_50to75k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_5 <- felm(log(no_counseling_75to100k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

no_counseling_6 <- felm(log(no_counseling_100to150k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))


no_counseling_7 <- felm(log(no_counseling_150to200k + 1) ~ stringency_index  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v11 %>% drop_na(pop),              weights = na.omit(hps_all_v11$pop))

htmlreg(l = list(no_counseling_1, no_counseling_2, no_counseling_3, no_counseling_4, no_counseling_5,
                 no_counseling_6, no_counseling_7), include.ci = FALSE, digits = 4, file = "therapy.doc")
```


```{r}
# drugs prcomp

pca_drugs <- searches_norm3_v20_5 %>%
        select(alcohol, cannabis, cigarette, e_cig, smoking)

pca_weights_drugs <- prcomp(pca_drugs)

rotation_drugs <- as_tibble(pca_weights_drugs$rotation, rownames = "term")

pca_addiction <- searches_norm3_v20_5 %>% 
        dplyr::select(addiction, alcoholism, rehab, substance_abuse)

pca_weights_addiction <- prcomp(pca_addiction)

rotation_addiction <- as_tibble(pca_weights_addiction$rotation, rownames = "term")
```

```{r}
# Drugs

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")

```

```{r}
# No weighting

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma,
                  data = searches_norm3_v20_5)

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            data = searches_norm3_v20_5)

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
       data = searches_norm3_v20_5)

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}

# Drugs

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) +
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) +
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) +
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                         factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                         factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")

```

```{r}
# staggered did

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144*alcohol + 0.833*cannabis + 0.451*cigarette + 
                            0.172*e_cig + 0.228*smoking + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308*addiction + 0.390*alcoholism + 0.104*rehab + 
                             0.861*substance_abuse + 1) ~ 
                                  busclose_first:year_indicator + 
                                     busopen_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# Drugs

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_pop_pct * year_indicator + 
                                     busopen_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")

```

```{r}
# all dmas
drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# Not normalized

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator + 
                                     busopen_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# Drugs with SIP

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")

```

```{r}
# No weighting

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma,
                  data = searches_norm3_v20_5)

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
            data = searches_norm3_v20_5)

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
       data = searches_norm3_v20_5)

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             data = searches_norm3_v20_5)

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}

# Drugs

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) +
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) +
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) +
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                        factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                         factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year) + 
                         factor(region):factor(month)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")

```

```{r}
# staggered did

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144*alcohol + 0.833*cannabis + 0.451*cigarette + 
                            0.172*e_cig + 0.228*smoking + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308*addiction + 0.390*alcoholism + 0.104*rehab + 
                             0.861*substance_abuse + 1) ~ 
                                  sip_first:year_indicator + 
                                     no_sip_most_pop:year_indicator + 
                        online_only:year_indicator + 
                        hybrid:year_indicator + 
                        other:year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# Drugs

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_5 <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs_5, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_pop_pct * year_indicator + 
                                     no_sip_pop_pct * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")

```

```{r}
# all dmas
drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20$pop),
                  data = searches_norm3_v20 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# Not normalized

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator + 
                                     no_sip_most_pop * year_indicator + 
                        online_only * year_indicator + 
                        hybrid * year_indicator + 
                        other * year_indicator + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_v24_5$pop),
                  data = searches_v24_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# black pct bus

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * black_pct + 
                                     busopen_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# Black percent SIP

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator * black_pct + 
                                     no_sip_most_pop * year_indicator * black_pct + 
                        online_only * year_indicator * black_pct + 
                        hybrid * year_indicator * black_pct + 
                        other * year_indicator * black_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```



```{r}
# white pct bus

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * white_pct + 
                                     busopen_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# white percent SIP

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator * white_pct + 
                                     no_sip_most_pop * year_indicator * white_pct + 
                        online_only * year_indicator * white_pct + 
                        hybrid * year_indicator * white_pct + 
                        other * year_indicator * white_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# popden bus

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * I(pop_den/100) + 
                                     busopen_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# popden SIP 

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator * I(pop_den/100) + 
                                     no_sip_most_pop * year_indicator * I(pop_den/100) + 
                        online_only * year_indicator * I(pop_den/100) + 
                        hybrid * year_indicator * I(pop_den/100) + 
                        other * year_indicator * I(pop_den/100) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# gop bus

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * gop_pct + 
                                     busopen_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# gop SIP

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator * gop_pct + 
                                     no_sip_most_pop * year_indicator * gop_pct + 
                        online_only * year_indicator * gop_pct + 
                        hybrid * year_indicator * gop_pct + 
                        other * year_indicator * gop_pct + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# income bus

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  busclose_first * year_indicator * I(median_income/1000) + 
                                     busopen_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# income SIP

drugs_1 <- felm(log(alcohol + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_2 <- felm(log(cannabis + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_3 <- felm(log(cigarette + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_4 <- felm(log(e_cig + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs <- felm(log(e_cig + cigarette + smoking + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_6 <- felm(log(0.144 * alcohol + 0.833 * cannabis + 0.451 * cigarette + 
                            0.172 * e_cig + 0.228 * smoking + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_1, drugs_2, drugs_3, drugs_4, drugs, drugs_6),
        include.ci = FALSE,
        digits = 4,
        file = "drugs.doc")

# index

drugs_7 <- felm(log(alcoholism + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_8 <- felm(log(addiction + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_9 <- felm(log(rehab + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_10 <- felm(log(substance_abuse + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

drugs_11 <- felm(log(0.308 * addiction + 0.390 * alcoholism + 0.104 * rehab + 
                             0.861 * substance_abuse + 1) ~ 
                                  sip_first * year_indicator * I(median_income/1000) + 
                                     no_sip_most_pop * year_indicator * I(median_income/1000) + 
                        online_only * year_indicator * I(median_income/1000) + 
                        hybrid * year_indicator * I(median_income/1000) + 
                        other * year_indicator * I(median_income/1000) + 
                        cases_per_100k + unemploy_rate + temp + precip + 
                       log(lockdown + 1) + log(covid + 1) + 
                       factor(income_support) + factor(debt_contract_relief)
                       |factor(week) + factor(dma) + factor(year)|0|dma, 
             weights = na.omit(searches_norm3_v20_5$pop),
                  data = searches_norm3_v20_5 %>% filter(is.na(pop) == FALSE))

htmlreg(l = list(drugs_7, drugs_8, drugs_9, drugs_10, drugs_11), digits = 4, include.ci = FALSE,
        file = "addiction.doc")
```

```{r}
# State regressions new, using our new method!!

depression_1 <- felm(log(hps_depression) ~ c1_post + c1_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

depression_2 <- felm(log(hps_depression) ~ c2_post + c2_future + 
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

depression_3 <- felm(log(hps_depression) ~ c6_post + c6_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

anxiety_1 <- felm(log(hps_anxiety) ~ c1_post + c1_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

anxiety_2 <- felm(log(hps_anxiety) ~ c2_post + c2_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

anxiety_3 <- felm(log(hps_anxiety) ~  c6_post + c6_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))



htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```
```{r}
# Unweighted

depression_1 <- felm(log(hps_depression) ~ c1_post + c1_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v13)

depression_2 <- felm(log(hps_depression) ~ c2_post + c2_future + 
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v13)

depression_3 <- felm(log(hps_depression) ~ c6_post + c6_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

anxiety_1 <- felm(log(hps_anxiety) ~ c1_post + c1_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v13)

anxiety_2 <- felm(log(hps_anxiety) ~ c2_post + c2_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
              data = hps_all_v13)

anxiety_3 <- felm(log(hps_anxiety) ~  c6_post + c6_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)



htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```


```{r}
# Using lockdown severity

depression_1 <- felm(log(hps_depression) ~ factor(c1_school_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12 %>% drop_na(pop),
             weights = na.omit(hps_all_v12$pop))

depression_2 <- felm(log(hps_depression) ~ factor(c2_workplace_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12 %>% drop_na(pop),
             weights = na.omit(hps_all_v12$pop))

depression_3 <- felm(log(hps_depression) ~ factor(c6_stay_at_home_requirements) + 
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12 %>% drop_na(pop),
             weights = na.omit(hps_all_v12$pop))

anxiety_1 <- felm(log(hps_anxiety) ~ factor(c1_school_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12 %>% drop_na(pop),
             weights = na.omit(hps_all_v12$pop))

anxiety_2 <- felm(log(hps_anxiety) ~ factor(c2_workplace_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12 %>% drop_na(pop),
             weights = na.omit(hps_all_v12$pop))

anxiety_3 <- felm(log(hps_anxiety) ~ factor(c6_stay_at_home_requirements) + 
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12 %>% drop_na(pop),
             weights = na.omit(hps_all_v12$pop))

htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
# Unweighted HPS

depression_1 <- felm(log(hps_depression) ~ factor(c1_school_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12)

depression_2 <- felm(log(hps_depression) ~ factor(c2_workplace_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12)

depression_3 <- felm(log(hps_depression) ~ factor(c6_stay_at_home_requirements) + 
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12)

anxiety_1 <- felm(log(hps_anxiety) ~ factor(c1_school_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12)

anxiety_2 <- felm(log(hps_anxiety) ~ factor(c2_workplace_closing) +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12)

anxiety_3 <- felm(log(hps_anxiety) ~ factor(c6_stay_at_home_requirements) + 
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v12)

htmlreg(l = list(depression_1, depression_2, depression_3, anxiety_1, anxiety_2, anxiety_3),
        include.ci = FALSE, digits = 4, file = "hps.doc")
```

```{r}
# HPS therapy

therapy_1 <- felm(log(counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_2 <- felm(log(counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_3 <- felm(log(counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_4 <- felm(log(medication) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_5 <- felm(log(medication) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_6 <- felm(log(medication) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_7 <- felm(log(no_counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_8 <- felm(log(no_counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

therapy_9 <- felm(log(no_counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),
             weights = na.omit(hps_all_v13$pop))

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5, therapy_6, therapy_7, 
                 therapy_8, therapy_9),
        include.ci = FALSE, digits = 4, file = "therapy.doc")

```

```{r}
# Unweighted

therapy_1 <- felm(log(counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_2 <- felm(log(counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_3 <- felm(log(counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

therapy_4 <- felm(log(medication) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_5 <- felm(log(medication) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

therapy_6 <- felm(log(medication) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
          data = hps_all_v13)

therapy_7 <- felm(log(no_counseling) ~ factor(c1_school_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_8 <- felm(log(no_counseling) ~ factor(c2_workplace_closing)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

therapy_9 <- felm(log(no_counseling) ~ factor(c6_stay_at_home_requirements)  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5, therapy_6, therapy_7, 
                 therapy_8, therapy_9),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
# ending
therapy_1 <- felm(log(counseling) ~ c1_post + c1_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_2 <- felm(log(counseling) ~ c2_post + c2_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_3 <- felm(log(counseling) ~ c6_post + c6_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_4 <- felm(log(medication) ~ c1_post + c1_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_5 <- felm(log(medication) ~ c2_post + c2_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_6 <- felm(log(medication) ~ c6_post + c6_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
          data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_7 <- felm(log(no_counseling) ~ c1_post + c1_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_8 <- felm(log(no_counseling) ~ c2_post + c2_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

therapy_9 <- felm(log(no_counseling) ~ c6_post + c6_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13 %>% drop_na(pop),              weights = na.omit(hps_all_v13$pop))

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5, therapy_6, therapy_7, 
                 therapy_8, therapy_9),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}
# ending
therapy_1 <- felm(log(counseling) ~ c1_post + c1_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_2 <- felm(log(counseling) ~ c2_post + c2_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_3 <- felm(log(counseling) ~ c6_post + c6_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

therapy_4 <- felm(log(medication) ~ c1_post + c1_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_5 <- felm(log(medication) ~ c2_post + c2_future +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

therapy_6 <- felm(log(medication) ~ c6_post + c6_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
          data = hps_all_v13)

therapy_7 <- felm(log(no_counseling) ~ c1_post + c1_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
             data = hps_all_v13)

therapy_8 <- felm(log(no_counseling) ~ c2_post + c2_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

therapy_9 <- felm(log(no_counseling) ~ c6_post + c6_future  +
               initclaims_combined + 
               contclaims_combined + cases_per_100k_5day + 
               factor(e1_income_support) + factor(e2_debt_contract_relief) + 
                log(covid_norm+1) + log(lockdown_norm+1)
             |factor(period) + factor(state) + factor(year)|0|state,
            data = hps_all_v13)

htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5, therapy_6, therapy_7, 
                 therapy_8, therapy_9),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

```{r}

```


```{r}


htmlreg(l = list(therapy_1, therapy_2, therapy_3, therapy_4, therapy_5),
        include.ci = FALSE, digits = 4, file = "therapy.doc")
```

